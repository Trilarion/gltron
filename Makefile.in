# Makefile for gltron

# experimental autoconf usage

prefix = @prefix@
includedir = @includedir@

SHELL = /bin/sh
OPT = -O2
# CFLAGS = -c -pedantic -Wall -DSOUND -DNETWORK
CFLAGS = -c -pedantic -Wall -DSOUND
GL_LIBS = -lm -lGL -lGLU -lSDL -lSDL_net -lpthread -lz -lpng
XLIBS = -L/usr/X11/lib -L/usr/X11R6/lib -lX11
SNDLIBS =  -lSDL_mixer

GLTRON_INSTALLDIR = /usr/bin
GLTRON_HOME = /usr/share/games/gltron

CFILES = \
	png_texture.c \
	pixels.c \
	switchCallbacks.c \
	gui.c \
	pause.c \
	computer.c \
	engine.c \
	game.c \
	gltron.c \
	gamegraphics.c \
	software.c \
	trail.c \
	input.c \
	settings.c \
	texture.c \
	load_texture.c \
	fonttex.c \
	fonts.c \
	menu.c \
	file.c \
	directory.c \
	model.c \
	modelgraphics.c \
	screenshot.c \
	mtllib.c \
	geom.c \
	system.c \
	globals.c \
	record.c \
	camera.c \
	console.c \
	network.c \
	system_net.c

SOUND_CFILES = \
	sound.c

OBJ = $(CFILES:.c=.o)
OBJ_SOUND = $(OBJ) $(SOUND_CFILES:.c=.o)

all: gltron

.c.o:
	$(CC) $(CFLAGS) $(OPT) $<

gltron: $(OBJ_SOUND)
	$(CC) $(OPT) -o gltron $(OBJ_SOUND) $(GL_LIBS) $(XLIBS) $(SNDLIBS)

INSTALL_FILES = gltron
DATA_FILES = data/* sounds/*wav

install: $(INSTALL_FILES)
	if [ ! -d $(GLTRON_INSTALLDIR) ] ; then \
	    mkdir -p $(GLTRON_INSTALLDIR) ; \
	fi
	if [ ! -d $(GLTRON_HOME) ] ; then \
	    mkdir -p $(GLTRON_HOME) ; \
	fi
	cp -f gltron $(GLTRON_INSTALLDIR)/gltron
	cp -R $(DATA_FILES) $(GLTRON_HOME)

clean: 
	rm -f *\.o gltron core
