# Makefile for gltron

# experimental autoconf usage

SHELL = @SHELL@
srcdir = @srcdir@
top_srcdir = @top_srcdir@
prefix = @prefix@
exec_prefix = @prefix@
bindir = @bindir@
datadir = ${prefix}/share/games/gltron

INSTALL = @INSTALL@
INSTALL_DATA = @INSTALL_DATA@
INSTALL_SCRIPT = @INSTALL_SCRIPT@

EXTRA_DIST =  README TODO CHANGELOG CREDITS INSTALL LICENSE README.html 
DIST_COMMON = Makefile.in configure.in config.h.in install-sh \
	data/* tools/* sounds/*

CC = @CC@

CFLAGS = -c @CFLAGS@ @INCS@
LIBS = @LIBS@

# fix these later
GLTRON_INSTALLDIR = ${bindir}
GLTRON_HOME = ${datadir}

HFILES = \
	data.h \
	gltron.h \
	png_texture.h \
	menu.h \
	geom.h \
	model.h \
	quad.h \
	renderer_gl.h \
	system.h \
	sound.h \
	system_net.h 


CFILES = \
	png_texture.c \
	pixels.c \
	switchCallbacks.c \
	gui.c \
	pause.c \
	computer.c \
	engine.c \
	event.c \
	game.c \
	gltron.c \
	gamegraphics.c \
	light.c \
	software.c \
	trail.c \
	trails_buffered.c \
	quad.c \
	quadbuf.c \
	input.c \
	settings.c \
	texture.c \
	load_texture.c \
	fonttex.c \
	fonts.c \
	menu.c \
	file.c \
	directory.c \
	model.c \
	modelgraphics.c \
	screenshot.c \
	mtllib.c \
	geom.c \
	system.c \
	globals.c \
	record.c \
	camera.c \
	console.c \
	renderer_gl.c \
	@NETWORK_FILES@
#	network.c \
#	system_net.c


SOUND_CFILES = \
	sound.c

DISTFILES = $(DIST_COMMON) $(EXTRA_DIST) $(CFILES) $(HFILES) $(SOUND_CFILES)

OBJ = $(CFILES:.c=.o)
OBJ_SOUND = $(OBJ) $(SOUND_CFILES:.c=.o)

all: gltron

.c.o:
	$(CC) $(CFLAGS) $(OPT) $<

gltron: $(OBJ_SOUND)
	$(CC) $(OPT) -o gltron $(OBJ_SOUND) $(LIBS)

INSTALL_FILES = gltron
DATA_FILES = data/* sounds/*wav

install: $(INSTALL_FILES)
	if [ ! -d $(GLTRON_INSTALLDIR) ] ; then \
	    mkdir -p $(GLTRON_INSTALLDIR) ; \
	fi
	if [ ! -d $(GLTRON_HOME) ] ; then \
	    mkdir -p $(GLTRON_HOME) ; \
	fi
	$(INSTALL) gltron $(GLTRON_INSTALLDIR)/gltron
	cp -R $(DATA_FILES) $(GLTRON_HOME)

clean: 
	rm -f *~ *\.o gltron core *#*

todo:
	perl todo2html.pl < TODO > TODO.html

etags:
	etags $(CFILES) $(HFILES)

distclean: clean
	rm -f config.cache config.status configure Makefile \
	sound.h sound.c system_net.c system_net.h system.c system.h
